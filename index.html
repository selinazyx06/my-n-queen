<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2566">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;N皇后问题可视化&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>.container {</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-width: 800px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 0 auto;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.controls {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.board {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: inline-block;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 2px solid #333;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.row {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.cell {</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 50px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 50px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: background-color 0.3s;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.cell.white { background-color: #fff; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.cell.black { background-color: #ddd; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.cell.queen { color: red; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.cell.checking { background-color: #ffeb3b; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.cell.invalid { background-color: #ff5252; }</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.solutions {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.solution-board {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: inline-block;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 10px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h1&gt;N皇后问题可视化&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="controls"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;label&gt;选择大小 (1-8): &lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;input type="number" id="boardSize" min="1" max="8" value="4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button id="solve"&gt;求解&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button id="next"&gt;下一步&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button id="auto"&gt;自动演示&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;span id="status"&gt;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="mainBoard" class="board"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="solutions"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;h2&gt;所有解法：&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="allSolutions"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>class QueensSolver {</p>
<p class="p1"><span class="Apple-converted-space">            </span>constructor(n) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>this.n = n;</p>
<p class="p1"><span class="Apple-converted-space">                </span>this.board = Array(n).fill().map(() =&gt; Array(n).fill('.'));</p>
<p class="p1"><span class="Apple-converted-space">                </span>this.solutions = [];</p>
<p class="p1"><span class="Apple-converted-space">                </span>this.currentRow = 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>this.currentCol = 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>this.isRunning = false;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>isValid(row, col) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// 检查同一列</p>
<p class="p1"><span class="Apple-converted-space">                </span>for (let i = 0; i &lt; row; i++) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (this.board[i][col] === 'Q') return false;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// 检查左上对角线</p>
<p class="p1"><span class="Apple-converted-space">                </span>for (let i = row - 1, j = col - 1; i &gt;= 0 &amp;&amp; j &gt;= 0; i--, j--) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (this.board[i][j] === 'Q') return false;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// 检查右上对角线</p>
<p class="p1"><span class="Apple-converted-space">                </span>for (let i = row - 1, j = col + 1; i &gt;= 0 &amp;&amp; j &lt; this.n; i--, j++) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (this.board[i][j] === 'Q') return false;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>return true;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>async step() {</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (this.currentRow === this.n) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>this.solutions.push(this.board.map(row =&gt; [...row]));</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return true;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (this.currentCol &gt;= this.n) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>this.currentCol = 0;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>this.currentRow--;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return false;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>await this.visualizeCheck(this.currentRow, this.currentCol);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (this.isValid(this.currentRow, this.currentCol)) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>this.board[this.currentRow][this.currentCol] = 'Q';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>await this.visualizeBoard();</p>
<p class="p1"><span class="Apple-converted-space">                    </span>this.currentRow++;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>this.currentCol = 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>this.currentCol++;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>return false;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>async visualizeCheck(row, col) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const cell = document.querySelector(`#mainBoard .cell[data-row="${row}"][data-col="${col}"]`);</p>
<p class="p1"><span class="Apple-converted-space">                </span>cell.classList.add('checking');</p>
<p class="p1"><span class="Apple-converted-space">                </span>await new Promise(resolve =&gt; setTimeout(resolve, 200));</p>
<p class="p1"><span class="Apple-converted-space">                </span>cell.classList.remove('checking');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>async visualizeBoard() {</p>
<p class="p1"><span class="Apple-converted-space">                </span>updateBoard(this.board);</p>
<p class="p1"><span class="Apple-converted-space">                </span>await new Promise(resolve =&gt; setTimeout(resolve, 300));</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>let solver = null;</p>
<p class="p1"><span class="Apple-converted-space">        </span>let autoInterval = null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function createBoard(n, container, board = null) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>container.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>for (let i = 0; i &lt; n; i++) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const row = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">                </span>row.className = 'row';</p>
<p class="p1"><span class="Apple-converted-space">                </span>for (let j = 0; j &lt; n; j++) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const cell = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>cell.className = `cell ${(i + j) % 2 ? 'black' : 'white'}`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>cell.dataset.row = i;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>cell.dataset.col = j;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (board &amp;&amp; board[i][j] === 'Q') {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>cell.textContent = '♕';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>cell.classList.add('queen');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>row.appendChild(cell);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>container.appendChild(row);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateBoard(board) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const cells = document.querySelectorAll('#mainBoard .cell');</p>
<p class="p1"><span class="Apple-converted-space">            </span>cells.forEach(cell =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const row = parseInt(cell.dataset.row);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const col = parseInt(cell.dataset.col);</p>
<p class="p1"><span class="Apple-converted-space">                </span>cell.textContent = board[row][col] === 'Q' ? '♕' : '';</p>
<p class="p1"><span class="Apple-converted-space">                </span>cell.classList.toggle('queen', board[row][col] === 'Q');</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function showSolutions(solutions) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const container = document.getElementById('allSolutions');</p>
<p class="p1"><span class="Apple-converted-space">            </span>container.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>solutions.forEach((solution, index) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const boardDiv = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">                </span>boardDiv.className = 'solution-board';</p>
<p class="p1"><span class="Apple-converted-space">                </span>boardDiv.innerHTML = `&lt;div&gt;解法 ${index + 1}&lt;/div&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">                </span>createBoard(solution.length, boardDiv, solution);</p>
<p class="p1"><span class="Apple-converted-space">                </span>container.appendChild(boardDiv);</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('solve').addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const n = parseInt(document.getElementById('boardSize').value);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const mainBoard = document.getElementById('mainBoard');</p>
<p class="p1"><span class="Apple-converted-space">            </span>createBoard(n, mainBoard);</p>
<p class="p1"><span class="Apple-converted-space">            </span>solver = new QueensSolver(n);</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('status').textContent = '开始求解...';</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('next').addEventListener('click', async () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!solver || solver.isRunning) return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>solver.isRunning = true;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const isDone = await solver.step();</p>
<p class="p1"><span class="Apple-converted-space">            </span>solver.isRunning = false;</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (isDone) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>showSolutions(solver.solutions);</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('status').textContent = `找到 ${solver.solutions.length} 个解法`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('auto').addEventListener('click', function() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (autoInterval) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>clearInterval(autoInterval);</p>
<p class="p1"><span class="Apple-converted-space">                </span>autoInterval = null;</p>
<p class="p1"><span class="Apple-converted-space">                </span>this.textContent = '自动演示';</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>this.textContent = '停止';</p>
<p class="p1"><span class="Apple-converted-space">            </span>autoInterval = setInterval(async () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (!solver || solver.isRunning) return;</p>
<p class="p1"><span class="Apple-converted-space">                </span>solver.isRunning = true;</p>
<p class="p1"><span class="Apple-converted-space">                </span>const isDone = await solver.step();</p>
<p class="p1"><span class="Apple-converted-space">                </span>solver.isRunning = false;</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (isDone) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>clearInterval(autoInterval);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>autoInterval = null;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>this.textContent = '自动演示';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>showSolutions(solver.solutions);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('status').textContent = `找到 ${solver.solutions.length} 个解法`;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}, 500);</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// 初始化4皇后问题</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('solve').click();</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
